function f(c){c=c.split("/").filter(Boolean);let a=0;for(const b of c)b.startsWith(":")&&a++;return[a,-c.length]}
function h(c,a){let b;try{b=new URL(a,location.origin)}catch{return null}if(b.pathname.length>1024)return null;a=Object.create(null);if(!c.i){for(var d of c.m){var e=d.pattern.exec(b);if(e){try{for(const [k,g]of Object.entries(e.pathname.groups))g!=null&&(a[k]=decodeURIComponent(g))}catch{break}return{g:d.g,h:a,url:b}}}return null}d=c.i;for(e of b.pathname.split("/").filter(Boolean)){if(e.length>128)return null;if(d.c.has(e))d=d.c.get(e);else if(d.c.has("*")){d=d.c.get("*");try{a[d.p]=decodeURIComponent(e)}catch{return null}}else return null}return d.j?
{g:d.j,h:a,url:b}:null}
class l{constructor(){this.m=[];this.i=globalThis.URLPattern?void 0:{c:new Map,j:null,p:null}}add(c,a){if(this.i){let b=this.i;for(const d of c.split("/").filter(Boolean)){const e=(c=d.startsWith(":"))?"*":d;b.c.has(e)||b.c.set(e,{c:new Map,j:null,p:c?d.slice(1):null});b=b.c.get(e)}b.j=a}else this.m.push({pattern:new globalThis.URLPattern({pathname:c}),g:a,l:f(c)}),this.m.sort((b,d)=>b.l[0]-d.l[0]||b.l[1]-d.l[1])}async navigate(c){var a=globalThis.navigation;if(a?.navigate)return a.navigate(c).finished;if(a=
h(this,c))history.pushState(null,"",c),await a.g(a.h,a.url)}init(){var c=globalThis.navigation;c?.navigate?c.addEventListener("navigate",a=>{if(a.canIntercept&&!a.hashChange&&!a.downloadRequest){var b=h(this,a.destination.url);b&&a.intercept({handler:async()=>{try{await b.g(b.h,b.url)}catch(d){console.error(d)}}})}}):(document.addEventListener("click",a=>{if(!a.defaultPrevented&&a.button===0){var b=a.target.closest("a");if(b&&!(a.metaKey||a.ctrlKey||a.shiftKey||a.altKey||b.target||b.hasAttribute("download"))){var d=
(b.rel||"").split(/\s+/);if(!(d.includes("external")||d.includes("noopener")||d.includes("noreferrer"))){try{var e=new URL(b.href,location.href)}catch{return}e.origin===location.origin&&(a.preventDefault(),this.navigate(e.pathname+e.search+e.hash))}}}}),window.addEventListener("popstate",()=>{const a=h(this,location.href);a&&a.g(a.h,a.url)}));(c=h(this,location.href))&&c.g(c.h,c.url)}};export const SimpleRouter=l;
